stepback: true

buildvariants:
    - display_name: Tests
      name: ubuntu
      run_on:
          - ubuntu2204-small
      tasks:
          - name: first-task
          - name: another-task
          - name: long-task
          - name: short-task
          - name: oops-another-task
          - name: noise-task-1
          - name: noise-task-2
          - name: noise-task-3
          - name: generator
          - name: task-group
          - name: task-d
          - name: task-e

functions:
    clone-project:
        command: git.get_project
        params:
            directory: src

task_groups:
  - name: task-group
    max_hosts: 2
    tasks:
      - task-a
      - task-b
      - task-c

tasks:
    - name: task-a
      patchable: false
      commands:
          - command: shell.exec
            params:
                script: "echo hello world"
    - name: task-b
      patch_only: true
      commands:
          - command: shell.exec
            params:
                script: "echo hello world"
    - name: task-c
      commands:
          - command: shell.exec
            params:
                script: "echo hello world"
      depends_on:
          - task-d
          - task-e
    - name: task-d
      patchable: false
      commands:
          - command: shell.exec
            params:
                script: "echo hello world"
    - name: task-e
      patchable: false
      commands:
          - command: shell.exec
            params:
                script: "echo hello world"
    - name: first-task
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    # exit 1 #1
    - name: another-task
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    # exit 1 #2
    - name: long-task
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    # exit 1 #8
    - name: short-task
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    # exit 1 #5
    - name: oops-another-task
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    # exit 1 #7
    - name: noise-task-1
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    exit 0
    - name: noise-task-2
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    exit 0
    - name: noise-task-3
      commands:
          - command: shell.exec
            params:
                script: |
                    echo "Task"
                    exit 0
    - name: generator
      commands:
          - func: clone-project
          - command: generate.tasks
            params:
                files:
                    - src/generator.json
                  